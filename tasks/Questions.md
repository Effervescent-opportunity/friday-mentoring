# Вопросы с ответами по заданиям и исправлениям


## Первое задание

 1. Достаточно ли текущего времени сервера, можно ли ему доверять, или же необходимо реализовать синхронизацию с чем-то доверенным?
>можем; если предположить, что мы не доверяем времени сервера, в коде приложения разработчику придётся делать много дополнительных вещей, которые выходят за рамки чисто прикладного программирования. Поэтому считаем, что времени сервера можно доверять, а синхронизация системных часов по NTP — задача поддержки инфраструктуры, а не разработческая.\
Реализовать дополнительную синхронизацию имеет смысл, если мы занимаемся генерацией, подписанием или проверкой электронной цифровой подписи. Это стандарт, которому приложение обязано следовать, иначе оно не пройдёт сертификацию (Приказ ФСБ РФ от 4 декабря 2020 г. N 555). У нас в задаче такого нет.
 2. Зачем в контроллере объявление переменной var nowInTimezone и потом передача ее в конструктор? Можно же сразу return new CurrentTimeResponse(clockService.getNowInUtc())
>Сугубо дело вкуса, но если часто и помногу использовать вложенные конструкции, это не упрощает читаемость кода, а отладку — так и вообще усложняет, потому что для вычисления значения переменной нужно или становиться внутрь конструктора, что достаточно далеко от места вызова, или же вычислять значение лапками, что минус пять секунд и немного потеря контекста в голове. Если таких случаев по коду много, разница удобства очень заметна.
 3. Точно ли хороший стиль объявлять record прямо внутри Контроллера, а не в отдельном классе? Если да, то почему?
>Стиль неплохой, тем более если альтернативы только две "выносить" или "не выносить". Во-первых, record компактен, вынос в маленький файл не увеличивает удобство, поэтому не выносим. Во-вторых, прыжки по файлам лишний раз размывают внимание, а пользы не приносят, поэтому опять же не выносим. В-третьих, объект локально используется в пределах контроллера и за его границы не протекает. Поэтому — не выносим. Итого — совсем нет причин выносить в нашем конкретном случае.
 4. Про вот это:     // !!! Очень изящная реализация теста через ISO DateTimeFormatter, она позволяет не заморачиваться с хаками наподобие isAfter/isBefore для времени, но мысль не была доведена до конца :(  Как можно довести ее до конца? Насколько я понимаю, всякие наносекунды совпадать не будут при получении now() в сервисе и в тесте
>В предложенной реализации идея собственно и доведена до конца: мы знаем точный ответ сервиса и проверяем, что ответ контроллера в точности совпадает с тем, что вернул сервис, т.е.: а) контроллер не модифицирует данные сервиса и б) выполняет преобразование в корректный формат.
 5. Вы в тесте написали var tz = "Asia/Paris"; вместо String ianaTimezone = "Europe/Paris";. Это просто по привычке или же лучше писать var вместо явного объявления типа? Почему?
>Мне персонально нравится variable type inference, потому что код выглядит максимально компактно. Любая среда разработки в 2023 году уже подсвечивает тип — на случай, если он зачем-то понадобится. Лучше/хуже — субъективно, вопрос скорее проектных соглашений, если это правило явно закреплено, и личных духовных предпочтений, если не закреплено. Главное — соблюдать тотальное единообразие в пределах одного репозитория, т.е. либо всегда используем var (там, где выведение типа возможно) либо всегда не используем.
